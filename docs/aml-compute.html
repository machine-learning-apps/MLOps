<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link type="text/css" href="/MLOps/css/pages.css" media="all" rel="stylesheet">

    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Aml Compute | Machine Learning Ops</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Aml Compute" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Usage The Azure Machine Learning Compute action will allow you to create a new compute target or check whether the specified compute target is available so you can later run your Machine Learning experiments or deploy your models remotely. If the compute target exists, it will just connect to it, otherwise the action can create a new compute target based on the provided parameters. Currently, the action only supports Azure ML Clusters and AKS Clusters. You will need to have azure credentials that allow you to create and/or connect to a workspace. This action requires an AML workspace to be created or attached to via the aml-workspace action. Template repositories This action is one in a series of actions that can be used to setup an ML Ops process. Examples of these can be found at Simple example: ml-template-azure and Comprehensive example: aml-template. Example workflow name: My Workflow on: [push, pull_request] jobs: build: runs-on: ubuntu-latest steps: # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it - name: Check Out Repository id: checkout_repository uses: actions/checkout@v2 # AML Workspace Action - uses: Azure/aml-workspace id: aml_workspace with: azure_credentials: $ # AML Compute Action - uses: Azure/aml-compute id: aml_compute with: # required inputs as secrets azure_credentials: $ # optional parameters_file: &quot;compute.json&quot; Inputs Input Required Default Description azure_credentials x - Output of az ad sp create-for-rbac --name &lt;your-sp-name&gt; --role contributor --scopes /subscriptions/&lt;your-subscriptionId&gt;/resourceGroups/&lt;your-rg&gt; --sdk-auth. This should be stored in your secrets parameters_file   &quot;compute.json&quot; JSON file in the .cloud/.azure folder specifying your Azure Machine Learning compute target details. Azure Credentials Azure credentials are required to connect to your Azure Machine Learning Workspace. These may have been created for an action you are already using in your repository, if so, you can skip the steps below. Install the Azure CLI on your computer or use the Cloud CLI and execute the following command to generate the required credentials: # Replace {service-principal-name}, {subscription-id} and {resource-group} with your Azure subscription id and resource group name and any name for your service principle az ad sp create-for-rbac --name {service-principal-name} \ --role contributor \ --scopes /subscriptions/{subscription-id}/resourceGroups/{resource-group} \ --sdk-auth This will generate the following JSON output: { &quot;clientId&quot;: &quot;&lt;GUID&gt;&quot;, &quot;clientSecret&quot;: &quot;&lt;GUID&gt;&quot;, &quot;subscriptionId&quot;: &quot;&lt;GUID&gt;&quot;, &quot;tenantId&quot;: &quot;&lt;GUID&gt;&quot;, (...) } Add this JSON output as a secret with the name AZURE_CREDENTIALS in your GitHub repository. Parameter File The action tries to load a JSON file in the .cloud/.azure folder in your repository, which specifies details of your Azure Machine Learning compute target. By default, the action is looking for a file with the name compute.json. If your JSON file has a different name, you can specify it with this input parameter. Currently, the action only supports Azure ML Clusters and AKS Clusters. Note that none of these values are required and in the absence, defaults will be created with the repo name. Sample files for AML and AKS clusters can be found in this repository in the folder .cloud/.azure. The JSON file can include the following parameters: Common parameters Parameter Required Allowed Values Default Description name   str The name of the of the Compute object to retrieve or create. max characters is 16 and it can include letters, digits and dashes. It must start with a letter and end with a letter or number compute_type (only for creating compute target) str: &quot;amlcluster&quot;, &quot;akscluster&quot; - Specifies the type of compute target that should be created by the action if a compute target with the specified name was not found. AML Cluster Parameter Required Allowed Values Default Description vm_size   str: &quot;Basic_A0&quot;, &quot;Standard_DS3_v2&quot;, etc. &quot;Standard_NC6&quot; The size of agent VMs. Note that not all sizes are available in all regions. vm_priority   str: &quot;dedicated&quot;, &quot;lowpriority&quot; &quot;dedicated&quot; The VM priority. min_nodes   int: [0, inf[ 0 The minimum number of nodes to use on the cluster. max_nodes   int: [1, inf[ 4 The maximum number of nodes to use on the cluster. idle_seconds_before_scaledown   int: [0, inf[ 120 Node idle time in seconds before scaling down the cluster. vnet_resource_group_name   str null The name of the resource group where the virtual network is located. vnet_name   str null The name of the virtual network. subnet_name   str null The name of the subnet inside the VNet. remote_login_port_public_access   str: &quot;Enabled&quot;, &quot;Disabled&quot;, &quot;NotSpecified&quot; &quot;NotSpecified&quot; State of the public SSH port. &quot;Disabled&quot; indicates that the public ssh port is closed on all nodes of the cluster. &quot;Enabled&quot; indicates that the public ssh port is open on all nodes of the cluster. &quot;NotSpecified&quot; indicates that the public ssh port is closed on all nodes of the cluster if VNet is defined, else is open all public nodes. It can be this default value only during cluster creation time. After creation, it will be either enabled or disabled. Please visit this website for more details. AKS Cluster Parameter Required Allowed Values Default Description agent_count   int: [1, inf[ 3 The number of agents (VMs) to host containers. vm_size   str: &quot;Standard_A1_v2&quot;, &quot;Standard_D3_v2&quot;, etc. &quot;Standard_D3_v2&quot; The size of agent VMs. location   str: supported region location of workspace The location to provision cluster in. service_cidr   str null A CIDR notation IP range from which to assign service cluster IPs. dns_service_ip   str null Containers DNS server IP address. docker_bridge_cidr   str null A CIDR notation IP for Docker bridge. cluster_purpose   str: &quot;DevTest&quot;, &quot;FastProd&quot; &quot;FastProd&quot; Targeted usage of the cluster. This is used to provision Azure Machine Learning components to ensure the desired level of fault-tolerance and QoS. &quot;FastProd&quot; will provision components to handle higher levels of traffic with production quality fault-tolerance. This will default the AKS cluster to have 3 nodes. &quot;DevTest&quot; will provision components at a minimal level for testing. This will default the AKS cluster to have 1 node. vnet_resource_group_name   str null The name of the resource group where the virtual network is located. vnet_name   str null The name of the virtual network. subnet_name   str null The name of the subnet inside the vnet. ssl_cname   str null A CName to use if enabling SSL validation on the cluster. Must provide all three CName, cert file, and key file to enable SSL validation. ssl_cert_pem_file   str null A file path to a file containing cert information for SSL validation. Must provide all three CName, cert file, and key file to enable SSL validation. ssl_key_pem_file   str null A file path to a file containing key information for SSL validation. Must provide all three CName, cert file, and key file to enable SSL validation. load_balancer_type   str: &quot;PublicIp&quot;, &quot;InternalLoadBalancer&quot; &quot;PublicIp&quot; Load balancer type of AKS cluster. load_balancer_subnet   str equal to subnet_name Load balancer subnet of AKS cluster. It can be used only when Internal Load Balancer is used as load balancer type. Please visit this website for more details. Outputs This action does not provide any outputs. Environment variables Certain parameters are considered secrets and should therefore be passed as environment variables from your secrets, if you want to use custom values. Environment variable Required Allowed Values Default Description ADMIN_USER_NAME   str null The name of the administrator user account which can be used to SSH into nodes. This parameter is AML Cluster specific. ADMIN_USER_PASSWORD   str null The password of the administrator user account. This parameter is AML Cluster specific. ADMIN_USER_SSH_KEY   str null The SSH public key of the administrator user account. This parameter is AML Cluster specific. Other Azure Machine Learning Actions aml-workspace - Connects to or creates a new workspace aml-compute - Connects to or creates a new compute target in Azure Machine Learning aml-run - Submits a ScriptRun, an Estimator or a Pipeline to Azure Machine Learning aml-registermodel - Registers a model to Azure Machine Learning aml-deploy - Deploys a model and creates an endpoint for the model Contributing This project welcomes contributions and suggestions. Most contributions require you to agree to a Contributor License Agreement (CLA) declaring that you have the right to, and actually do, grant us the rights to use your contribution. For details, visit https://cla.opensource.microsoft.com. When you submit a pull request, a CLA bot will automatically determine whether you need to provide a CLA and decorate the PR appropriately (e.g., status check, comment). Simply follow the instructions provided by the bot. You will only need to do this once across all repos using our CLA. This project has adopted the Microsoft Open Source Code of Conduct. For more information see the Code of Conduct FAQ or contact opencode@microsoft.com with any additional questions or comments." />
<meta property="og:description" content="Usage The Azure Machine Learning Compute action will allow you to create a new compute target or check whether the specified compute target is available so you can later run your Machine Learning experiments or deploy your models remotely. If the compute target exists, it will just connect to it, otherwise the action can create a new compute target based on the provided parameters. Currently, the action only supports Azure ML Clusters and AKS Clusters. You will need to have azure credentials that allow you to create and/or connect to a workspace. This action requires an AML workspace to be created or attached to via the aml-workspace action. Template repositories This action is one in a series of actions that can be used to setup an ML Ops process. Examples of these can be found at Simple example: ml-template-azure and Comprehensive example: aml-template. Example workflow name: My Workflow on: [push, pull_request] jobs: build: runs-on: ubuntu-latest steps: # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it - name: Check Out Repository id: checkout_repository uses: actions/checkout@v2 # AML Workspace Action - uses: Azure/aml-workspace id: aml_workspace with: azure_credentials: $ # AML Compute Action - uses: Azure/aml-compute id: aml_compute with: # required inputs as secrets azure_credentials: $ # optional parameters_file: &quot;compute.json&quot; Inputs Input Required Default Description azure_credentials x - Output of az ad sp create-for-rbac --name &lt;your-sp-name&gt; --role contributor --scopes /subscriptions/&lt;your-subscriptionId&gt;/resourceGroups/&lt;your-rg&gt; --sdk-auth. This should be stored in your secrets parameters_file   &quot;compute.json&quot; JSON file in the .cloud/.azure folder specifying your Azure Machine Learning compute target details. Azure Credentials Azure credentials are required to connect to your Azure Machine Learning Workspace. These may have been created for an action you are already using in your repository, if so, you can skip the steps below. Install the Azure CLI on your computer or use the Cloud CLI and execute the following command to generate the required credentials: # Replace {service-principal-name}, {subscription-id} and {resource-group} with your Azure subscription id and resource group name and any name for your service principle az ad sp create-for-rbac --name {service-principal-name} \ --role contributor \ --scopes /subscriptions/{subscription-id}/resourceGroups/{resource-group} \ --sdk-auth This will generate the following JSON output: { &quot;clientId&quot;: &quot;&lt;GUID&gt;&quot;, &quot;clientSecret&quot;: &quot;&lt;GUID&gt;&quot;, &quot;subscriptionId&quot;: &quot;&lt;GUID&gt;&quot;, &quot;tenantId&quot;: &quot;&lt;GUID&gt;&quot;, (...) } Add this JSON output as a secret with the name AZURE_CREDENTIALS in your GitHub repository. Parameter File The action tries to load a JSON file in the .cloud/.azure folder in your repository, which specifies details of your Azure Machine Learning compute target. By default, the action is looking for a file with the name compute.json. If your JSON file has a different name, you can specify it with this input parameter. Currently, the action only supports Azure ML Clusters and AKS Clusters. Note that none of these values are required and in the absence, defaults will be created with the repo name. Sample files for AML and AKS clusters can be found in this repository in the folder .cloud/.azure. The JSON file can include the following parameters: Common parameters Parameter Required Allowed Values Default Description name   str The name of the of the Compute object to retrieve or create. max characters is 16 and it can include letters, digits and dashes. It must start with a letter and end with a letter or number compute_type (only for creating compute target) str: &quot;amlcluster&quot;, &quot;akscluster&quot; - Specifies the type of compute target that should be created by the action if a compute target with the specified name was not found. AML Cluster Parameter Required Allowed Values Default Description vm_size   str: &quot;Basic_A0&quot;, &quot;Standard_DS3_v2&quot;, etc. &quot;Standard_NC6&quot; The size of agent VMs. Note that not all sizes are available in all regions. vm_priority   str: &quot;dedicated&quot;, &quot;lowpriority&quot; &quot;dedicated&quot; The VM priority. min_nodes   int: [0, inf[ 0 The minimum number of nodes to use on the cluster. max_nodes   int: [1, inf[ 4 The maximum number of nodes to use on the cluster. idle_seconds_before_scaledown   int: [0, inf[ 120 Node idle time in seconds before scaling down the cluster. vnet_resource_group_name   str null The name of the resource group where the virtual network is located. vnet_name   str null The name of the virtual network. subnet_name   str null The name of the subnet inside the VNet. remote_login_port_public_access   str: &quot;Enabled&quot;, &quot;Disabled&quot;, &quot;NotSpecified&quot; &quot;NotSpecified&quot; State of the public SSH port. &quot;Disabled&quot; indicates that the public ssh port is closed on all nodes of the cluster. &quot;Enabled&quot; indicates that the public ssh port is open on all nodes of the cluster. &quot;NotSpecified&quot; indicates that the public ssh port is closed on all nodes of the cluster if VNet is defined, else is open all public nodes. It can be this default value only during cluster creation time. After creation, it will be either enabled or disabled. Please visit this website for more details. AKS Cluster Parameter Required Allowed Values Default Description agent_count   int: [1, inf[ 3 The number of agents (VMs) to host containers. vm_size   str: &quot;Standard_A1_v2&quot;, &quot;Standard_D3_v2&quot;, etc. &quot;Standard_D3_v2&quot; The size of agent VMs. location   str: supported region location of workspace The location to provision cluster in. service_cidr   str null A CIDR notation IP range from which to assign service cluster IPs. dns_service_ip   str null Containers DNS server IP address. docker_bridge_cidr   str null A CIDR notation IP for Docker bridge. cluster_purpose   str: &quot;DevTest&quot;, &quot;FastProd&quot; &quot;FastProd&quot; Targeted usage of the cluster. This is used to provision Azure Machine Learning components to ensure the desired level of fault-tolerance and QoS. &quot;FastProd&quot; will provision components to handle higher levels of traffic with production quality fault-tolerance. This will default the AKS cluster to have 3 nodes. &quot;DevTest&quot; will provision components at a minimal level for testing. This will default the AKS cluster to have 1 node. vnet_resource_group_name   str null The name of the resource group where the virtual network is located. vnet_name   str null The name of the virtual network. subnet_name   str null The name of the subnet inside the vnet. ssl_cname   str null A CName to use if enabling SSL validation on the cluster. Must provide all three CName, cert file, and key file to enable SSL validation. ssl_cert_pem_file   str null A file path to a file containing cert information for SSL validation. Must provide all three CName, cert file, and key file to enable SSL validation. ssl_key_pem_file   str null A file path to a file containing key information for SSL validation. Must provide all three CName, cert file, and key file to enable SSL validation. load_balancer_type   str: &quot;PublicIp&quot;, &quot;InternalLoadBalancer&quot; &quot;PublicIp&quot; Load balancer type of AKS cluster. load_balancer_subnet   str equal to subnet_name Load balancer subnet of AKS cluster. It can be used only when Internal Load Balancer is used as load balancer type. Please visit this website for more details. Outputs This action does not provide any outputs. Environment variables Certain parameters are considered secrets and should therefore be passed as environment variables from your secrets, if you want to use custom values. Environment variable Required Allowed Values Default Description ADMIN_USER_NAME   str null The name of the administrator user account which can be used to SSH into nodes. This parameter is AML Cluster specific. ADMIN_USER_PASSWORD   str null The password of the administrator user account. This parameter is AML Cluster specific. ADMIN_USER_SSH_KEY   str null The SSH public key of the administrator user account. This parameter is AML Cluster specific. Other Azure Machine Learning Actions aml-workspace - Connects to or creates a new workspace aml-compute - Connects to or creates a new compute target in Azure Machine Learning aml-run - Submits a ScriptRun, an Estimator or a Pipeline to Azure Machine Learning aml-registermodel - Registers a model to Azure Machine Learning aml-deploy - Deploys a model and creates an endpoint for the model Contributing This project welcomes contributions and suggestions. Most contributions require you to agree to a Contributor License Agreement (CLA) declaring that you have the right to, and actually do, grant us the rights to use your contribution. For details, visit https://cla.opensource.microsoft.com. When you submit a pull request, a CLA bot will automatically determine whether you need to provide a CLA and decorate the PR appropriately (e.g., status check, comment). Simply follow the instructions provided by the bot. You will only need to do this once across all repos using our CLA. This project has adopted the Microsoft Open Source Code of Conduct. For more information see the Code of Conduct FAQ or contact opencode@microsoft.com with any additional questions or comments." />
<link rel="canonical" href="https://machine-learning-apps.github.io/MLOps/docs/aml-compute.html" />
<meta property="og:url" content="https://machine-learning-apps.github.io/MLOps/docs/aml-compute.html" />
<meta property="og:site_name" content="Machine Learning Ops" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-04-20T15:18:27-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Aml Compute" />
<meta name="twitter:site" content="@github" />
<script type="application/ld+json">
{"headline":"Aml Compute","dateModified":"2020-04-20T15:18:27-05:00","datePublished":"2020-04-20T15:18:27-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://machine-learning-apps.github.io/MLOps/docs/aml-compute.html"},"url":"https://machine-learning-apps.github.io/MLOps/docs/aml-compute.html","description":"Usage The Azure Machine Learning Compute action will allow you to create a new compute target or check whether the specified compute target is available so you can later run your Machine Learning experiments or deploy your models remotely. If the compute target exists, it will just connect to it, otherwise the action can create a new compute target based on the provided parameters. Currently, the action only supports Azure ML Clusters and AKS Clusters. You will need to have azure credentials that allow you to create and/or connect to a workspace. This action requires an AML workspace to be created or attached to via the aml-workspace action. Template repositories This action is one in a series of actions that can be used to setup an ML Ops process. Examples of these can be found at Simple example: ml-template-azure and Comprehensive example: aml-template. Example workflow name: My Workflow on: [push, pull_request] jobs: build: runs-on: ubuntu-latest steps: # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it - name: Check Out Repository id: checkout_repository uses: actions/checkout@v2 # AML Workspace Action - uses: Azure/aml-workspace id: aml_workspace with: azure_credentials: $ # AML Compute Action - uses: Azure/aml-compute id: aml_compute with: # required inputs as secrets azure_credentials: $ # optional parameters_file: &quot;compute.json&quot; Inputs Input Required Default Description azure_credentials x - Output of az ad sp create-for-rbac --name &lt;your-sp-name&gt; --role contributor --scopes /subscriptions/&lt;your-subscriptionId&gt;/resourceGroups/&lt;your-rg&gt; --sdk-auth. This should be stored in your secrets parameters_file   &quot;compute.json&quot; JSON file in the .cloud/.azure folder specifying your Azure Machine Learning compute target details. Azure Credentials Azure credentials are required to connect to your Azure Machine Learning Workspace. These may have been created for an action you are already using in your repository, if so, you can skip the steps below. Install the Azure CLI on your computer or use the Cloud CLI and execute the following command to generate the required credentials: # Replace {service-principal-name}, {subscription-id} and {resource-group} with your Azure subscription id and resource group name and any name for your service principle az ad sp create-for-rbac --name {service-principal-name} \\ --role contributor \\ --scopes /subscriptions/{subscription-id}/resourceGroups/{resource-group} \\ --sdk-auth This will generate the following JSON output: { &quot;clientId&quot;: &quot;&lt;GUID&gt;&quot;, &quot;clientSecret&quot;: &quot;&lt;GUID&gt;&quot;, &quot;subscriptionId&quot;: &quot;&lt;GUID&gt;&quot;, &quot;tenantId&quot;: &quot;&lt;GUID&gt;&quot;, (...) } Add this JSON output as a secret with the name AZURE_CREDENTIALS in your GitHub repository. Parameter File The action tries to load a JSON file in the .cloud/.azure folder in your repository, which specifies details of your Azure Machine Learning compute target. By default, the action is looking for a file with the name compute.json. If your JSON file has a different name, you can specify it with this input parameter. Currently, the action only supports Azure ML Clusters and AKS Clusters. Note that none of these values are required and in the absence, defaults will be created with the repo name. Sample files for AML and AKS clusters can be found in this repository in the folder .cloud/.azure. The JSON file can include the following parameters: Common parameters Parameter Required Allowed Values Default Description name   str The name of the of the Compute object to retrieve or create. max characters is 16 and it can include letters, digits and dashes. It must start with a letter and end with a letter or number compute_type (only for creating compute target) str: &quot;amlcluster&quot;, &quot;akscluster&quot; - Specifies the type of compute target that should be created by the action if a compute target with the specified name was not found. AML Cluster Parameter Required Allowed Values Default Description vm_size   str: &quot;Basic_A0&quot;, &quot;Standard_DS3_v2&quot;, etc. &quot;Standard_NC6&quot; The size of agent VMs. Note that not all sizes are available in all regions. vm_priority   str: &quot;dedicated&quot;, &quot;lowpriority&quot; &quot;dedicated&quot; The VM priority. min_nodes   int: [0, inf[ 0 The minimum number of nodes to use on the cluster. max_nodes   int: [1, inf[ 4 The maximum number of nodes to use on the cluster. idle_seconds_before_scaledown   int: [0, inf[ 120 Node idle time in seconds before scaling down the cluster. vnet_resource_group_name   str null The name of the resource group where the virtual network is located. vnet_name   str null The name of the virtual network. subnet_name   str null The name of the subnet inside the VNet. remote_login_port_public_access   str: &quot;Enabled&quot;, &quot;Disabled&quot;, &quot;NotSpecified&quot; &quot;NotSpecified&quot; State of the public SSH port. &quot;Disabled&quot; indicates that the public ssh port is closed on all nodes of the cluster. &quot;Enabled&quot; indicates that the public ssh port is open on all nodes of the cluster. &quot;NotSpecified&quot; indicates that the public ssh port is closed on all nodes of the cluster if VNet is defined, else is open all public nodes. It can be this default value only during cluster creation time. After creation, it will be either enabled or disabled. Please visit this website for more details. AKS Cluster Parameter Required Allowed Values Default Description agent_count   int: [1, inf[ 3 The number of agents (VMs) to host containers. vm_size   str: &quot;Standard_A1_v2&quot;, &quot;Standard_D3_v2&quot;, etc. &quot;Standard_D3_v2&quot; The size of agent VMs. location   str: supported region location of workspace The location to provision cluster in. service_cidr   str null A CIDR notation IP range from which to assign service cluster IPs. dns_service_ip   str null Containers DNS server IP address. docker_bridge_cidr   str null A CIDR notation IP for Docker bridge. cluster_purpose   str: &quot;DevTest&quot;, &quot;FastProd&quot; &quot;FastProd&quot; Targeted usage of the cluster. This is used to provision Azure Machine Learning components to ensure the desired level of fault-tolerance and QoS. &quot;FastProd&quot; will provision components to handle higher levels of traffic with production quality fault-tolerance. This will default the AKS cluster to have 3 nodes. &quot;DevTest&quot; will provision components at a minimal level for testing. This will default the AKS cluster to have 1 node. vnet_resource_group_name   str null The name of the resource group where the virtual network is located. vnet_name   str null The name of the virtual network. subnet_name   str null The name of the subnet inside the vnet. ssl_cname   str null A CName to use if enabling SSL validation on the cluster. Must provide all three CName, cert file, and key file to enable SSL validation. ssl_cert_pem_file   str null A file path to a file containing cert information for SSL validation. Must provide all three CName, cert file, and key file to enable SSL validation. ssl_key_pem_file   str null A file path to a file containing key information for SSL validation. Must provide all three CName, cert file, and key file to enable SSL validation. load_balancer_type   str: &quot;PublicIp&quot;, &quot;InternalLoadBalancer&quot; &quot;PublicIp&quot; Load balancer type of AKS cluster. load_balancer_subnet   str equal to subnet_name Load balancer subnet of AKS cluster. It can be used only when Internal Load Balancer is used as load balancer type. Please visit this website for more details. Outputs This action does not provide any outputs. Environment variables Certain parameters are considered secrets and should therefore be passed as environment variables from your secrets, if you want to use custom values. Environment variable Required Allowed Values Default Description ADMIN_USER_NAME   str null The name of the administrator user account which can be used to SSH into nodes. This parameter is AML Cluster specific. ADMIN_USER_PASSWORD   str null The password of the administrator user account. This parameter is AML Cluster specific. ADMIN_USER_SSH_KEY   str null The SSH public key of the administrator user account. This parameter is AML Cluster specific. Other Azure Machine Learning Actions aml-workspace - Connects to or creates a new workspace aml-compute - Connects to or creates a new compute target in Azure Machine Learning aml-run - Submits a ScriptRun, an Estimator or a Pipeline to Azure Machine Learning aml-registermodel - Registers a model to Azure Machine Learning aml-deploy - Deploys a model and creates an endpoint for the model Contributing This project welcomes contributions and suggestions. Most contributions require you to agree to a Contributor License Agreement (CLA) declaring that you have the right to, and actually do, grant us the rights to use your contribution. For details, visit https://cla.opensource.microsoft.com. When you submit a pull request, a CLA bot will automatically determine whether you need to provide a CLA and decorate the PR appropriately (e.g., status check, comment). Simply follow the instructions provided by the bot. You will only need to do this once across all repos using our CLA. This project has adopted the Microsoft Open Source Code of Conduct. For more information see the Code of Conduct FAQ or contact opencode@microsoft.com with any additional questions or comments.","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body class="document /docs/aml-compute">

<div class="topnav">
    <a href="/MLOps/">MLOps</a>
    <a href="/MLOps/actions">Actions</a>
    <a href="/MLOps/templates">Templates</a>
    <a href="/MLOps/docs">Docs</a>
    <a href="https://github.com/machine-learning-apps/MLOps" class="help-link">MLOps Repository</a>
  </div>

<section id="hero-spot" class="hero-spot">
    <a href="/MLOps/"><img src="/MLOps/images/MLOps.png" alt="ML Ops" class="logo" /></a>

<h1 class="title">Aml Compute</h1>

</section>

<section class="content">

<h2 id="usage">Usage</h2>

<p>The Azure Machine Learning Compute action will allow you to create a new compute target or check whether the specified compute target is available so you can later run your Machine Learning experiments or deploy your models remotely. If the compute target exists, it will just connect to it, otherwise the action can create a new compute target based on the provided parameters. Currently, the action only supports Azure ML Clusters and AKS Clusters. You will need to have azure credentials that allow you to create and/or connect to a workspace.</p>

<p>This action requires an AML workspace to be created or attached to via the <a href="https://github.com/Azure/aml-workspace">aml-workspace</a> action.</p>

<h2 id="template-repositories">Template repositories</h2>

<p>This action is one in a series of actions that can be used to setup an ML Ops process. Examples of these can be found at</p>
<ol>
  <li>Simple example: <a href="https://github.com/machine-learning-apps/ml-template-azure">ml-template-azure</a> and</li>
  <li>Comprehensive example: <a href="https://github.com/Azure/aml-template">aml-template</a>.</li>
</ol>

<h3 id="example-workflow">Example workflow</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">My Workflow</span>
<span class="na">on</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">push</span><span class="pi">,</span> <span class="nv">pull_request</span><span class="pi">]</span>
<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">build</span><span class="pi">:</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="na">steps</span><span class="pi">:</span>
    <span class="c1"># Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Check Out Repository</span>
      <span class="na">id</span><span class="pi">:</span> <span class="s">checkout_repository</span>
      <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v2</span>

    <span class="c1"># AML Workspace Action</span>
    <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">Azure/aml-workspace</span>
      <span class="na">id</span><span class="pi">:</span> <span class="s">aml_workspace</span>
      <span class="na">with</span><span class="pi">:</span>
        <span class="na">azure_credentials</span><span class="pi">:</span> <span class="s">$</span>

    <span class="c1"># AML Compute Action</span>
    <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">Azure/aml-compute</span>
      <span class="na">id</span><span class="pi">:</span> <span class="s">aml_compute</span>
      <span class="na">with</span><span class="pi">:</span>
        <span class="c1"># required inputs as secrets</span>
        <span class="na">azure_credentials</span><span class="pi">:</span> <span class="s">$</span>
        <span class="c1"># optional</span>
        <span class="na">parameters_file</span><span class="pi">:</span> <span class="s2">"</span><span class="s">compute.json"</span>
</code></pre></div></div>

<h3 id="inputs">Inputs</h3>

<table>
  <thead>
    <tr>
      <th>Input</th>
      <th>Required</th>
      <th>Default</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>azure_credentials</td>
      <td>x</td>
      <td>-</td>
      <td>Output of <code class="language-plaintext highlighter-rouge">az ad sp create-for-rbac --name &lt;your-sp-name&gt; --role contributor --scopes /subscriptions/&lt;your-subscriptionId&gt;/resourceGroups/&lt;your-rg&gt; --sdk-auth</code>. This should be stored in your secrets</td>
    </tr>
    <tr>
      <td>parameters_file</td>
      <td> </td>
      <td><code class="language-plaintext highlighter-rouge">"compute.json"</code></td>
      <td>JSON file in the <code class="language-plaintext highlighter-rouge">.cloud/.azure</code> folder specifying your Azure Machine Learning compute target details.</td>
    </tr>
  </tbody>
</table>

<h4 id="azure-credentials">Azure Credentials</h4>

<p>Azure credentials are required to connect to your Azure Machine Learning Workspace. These may have been created for an action you are already using in your repository, if so, you can skip the steps below.</p>

<p>Install the <a href="https://docs.microsoft.com/en-us/cli/azure/install-azure-cli?view=azure-cli-latest">Azure CLI</a> on your computer or use the Cloud CLI and execute the following command to generate the required credentials:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Replace {service-principal-name}, {subscription-id} and {resource-group} with your Azure subscription id and resource group name and any name for your service principle</span>
az ad sp create-for-rbac <span class="nt">--name</span> <span class="o">{</span>service-principal-name<span class="o">}</span> <span class="se">\</span>
                         <span class="nt">--role</span> contributor <span class="se">\</span>
                         <span class="nt">--scopes</span> /subscriptions/<span class="o">{</span>subscription-id<span class="o">}</span>/resourceGroups/<span class="o">{</span>resource-group<span class="o">}</span> <span class="se">\</span>
                         <span class="nt">--sdk-auth</span>
</code></pre></div></div>

<p>This will generate the following JSON output:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">{</span>
  <span class="s2">"clientId"</span>: <span class="s2">"&lt;GUID&gt;"</span>,
  <span class="s2">"clientSecret"</span>: <span class="s2">"&lt;GUID&gt;"</span>,
  <span class="s2">"subscriptionId"</span>: <span class="s2">"&lt;GUID&gt;"</span>,
  <span class="s2">"tenantId"</span>: <span class="s2">"&lt;GUID&gt;"</span>,
  <span class="o">(</span>...<span class="o">)</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Add this JSON output as <a href="https://help.github.com/en/actions/configuring-and-managing-workflows/creating-and-storing-encrypted-secrets#creating-encrypted-secrets">a secret</a> with the name <code class="language-plaintext highlighter-rouge">AZURE_CREDENTIALS</code> in your GitHub repository.</p>

<h4 id="parameter-file">Parameter File</h4>

<p>The action tries to load a JSON file in the <code class="language-plaintext highlighter-rouge">.cloud/.azure</code> folder in your repository, which specifies details of your Azure Machine Learning compute target. By default, the action is looking for a file with the name <code class="language-plaintext highlighter-rouge">compute.json</code>. If your JSON file has a different name, you can specify it with this input parameter. Currently, the action only supports Azure ML Clusters and AKS Clusters. Note that none of these values are required and in the absence, defaults will be created with the repo name.</p>

<p>Sample files for AML and AKS clusters can be found in this repository in the folder <code class="language-plaintext highlighter-rouge">.cloud/.azure</code>. The JSON file can include the following parameters:</p>

<h5 id="common-parameters">Common parameters</h5>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Required</th>
      <th>Allowed Values</th>
      <th>Default</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>name</td>
      <td> </td>
      <td>str</td>
      <td><REPOSITORY_NAME></REPOSITORY_NAME></td>
      <td>The name of the of the Compute object to retrieve or create. max characters is 16 and it can include letters, digits and dashes. It must start with a letter and end with a letter or number</td>
    </tr>
    <tr>
      <td>compute_type</td>
      <td>(only for creating compute target)</td>
      <td>str: <code class="language-plaintext highlighter-rouge">"amlcluster"</code>, <code class="language-plaintext highlighter-rouge">"akscluster"</code></td>
      <td>-</td>
      <td>Specifies the type of compute target that should be created by the action if a compute target with the specified name was not found.</td>
    </tr>
  </tbody>
</table>

<h5 id="aml-cluster">AML Cluster</h5>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Required</th>
      <th>Allowed Values</th>
      <th>Default</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>vm_size</td>
      <td> </td>
      <td>str: <a href="https://docs.microsoft.com/en-us/azure/templates/Microsoft.Compute/2019-07-01/virtualMachines?toc=%2Fen-us%2Fazure%2Fazure-resource-manager%2Ftoc.json&amp;bc=%2Fen-us%2Fazure%2Fbread%2Ftoc.json#hardwareprofile-object"><code class="language-plaintext highlighter-rouge">"Basic_A0"</code>, <code class="language-plaintext highlighter-rouge">"Standard_DS3_v2"</code>, etc.</a></td>
      <td><code class="language-plaintext highlighter-rouge">"Standard_NC6"</code></td>
      <td>The size of agent VMs. Note that not all sizes are available in all regions.</td>
    </tr>
    <tr>
      <td>vm_priority</td>
      <td> </td>
      <td>str: <code class="language-plaintext highlighter-rouge">"dedicated"</code>, <code class="language-plaintext highlighter-rouge">"lowpriority"</code></td>
      <td><code class="language-plaintext highlighter-rouge">"dedicated"</code></td>
      <td>The VM priority.</td>
    </tr>
    <tr>
      <td>min_nodes</td>
      <td> </td>
      <td>int: [0, inf[</td>
      <td>0</td>
      <td>The minimum number of nodes to use on the cluster.</td>
    </tr>
    <tr>
      <td>max_nodes</td>
      <td> </td>
      <td>int: [1, inf[</td>
      <td>4</td>
      <td>The maximum number of nodes to use on the cluster.</td>
    </tr>
    <tr>
      <td>idle_seconds_before_scaledown</td>
      <td> </td>
      <td>int: [0, inf[</td>
      <td>120</td>
      <td>Node idle time in seconds before scaling down the cluster.</td>
    </tr>
    <tr>
      <td>vnet_resource_group_name</td>
      <td> </td>
      <td>str</td>
      <td>null</td>
      <td>The name of the resource group where the virtual network is located.</td>
    </tr>
    <tr>
      <td>vnet_name</td>
      <td> </td>
      <td>str</td>
      <td>null</td>
      <td>The name of the virtual network.</td>
    </tr>
    <tr>
      <td>subnet_name</td>
      <td> </td>
      <td>str</td>
      <td>null</td>
      <td>The name of the subnet inside the VNet.</td>
    </tr>
    <tr>
      <td>remote_login_port_public_access</td>
      <td> </td>
      <td>str: <code class="language-plaintext highlighter-rouge">"Enabled"</code>, <code class="language-plaintext highlighter-rouge">"Disabled"</code>, <code class="language-plaintext highlighter-rouge">"NotSpecified"</code></td>
      <td><code class="language-plaintext highlighter-rouge">"NotSpecified"</code></td>
      <td>State of the public SSH port. <code class="language-plaintext highlighter-rouge">"Disabled"</code> indicates that the public ssh port is closed on all nodes of the cluster. <code class="language-plaintext highlighter-rouge">"Enabled"</code> indicates that the public ssh port is open on all nodes of the cluster. <code class="language-plaintext highlighter-rouge">"NotSpecified"</code> indicates that the public ssh port is closed on all nodes of the cluster if VNet is defined, else is open all public nodes. It can be this default value only during cluster creation time. After creation, it will be either enabled or disabled.</td>
    </tr>
  </tbody>
</table>

<p>Please visit <a href="">this website</a> for more details.</p>

<h5 id="aks-cluster">AKS Cluster</h5>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Required</th>
      <th>Allowed Values</th>
      <th>Default</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>agent_count</td>
      <td> </td>
      <td>int: [1, inf[</td>
      <td>3</td>
      <td>The number of agents (VMs) to host containers.</td>
    </tr>
    <tr>
      <td>vm_size</td>
      <td> </td>
      <td>str: <a href="https://docs.microsoft.com/en-us/azure/templates/Microsoft.ContainerService/2020-02-01/managedClusters?toc=%2Fen-us%2Fazure%2Fazure-resource-manager%2Ftoc.json&amp;bc=%2Fen-us%2Fazure%2Fbread%2Ftoc.json#managedclusteragentpoolprofile-object"><code class="language-plaintext highlighter-rouge">"Standard_A1_v2"</code>, <code class="language-plaintext highlighter-rouge">"Standard_D3_v2"</code>, etc.</a></td>
      <td><code class="language-plaintext highlighter-rouge">"Standard_D3_v2"</code></td>
      <td>The size of agent VMs.</td>
    </tr>
    <tr>
      <td>location</td>
      <td> </td>
      <td>str: <a href="https://azure.microsoft.com/en-us/global-infrastructure/services/?regions=all&amp;products=kubernetes-service">supported region</a></td>
      <td>location of workspace</td>
      <td>The location to provision cluster in.</td>
    </tr>
    <tr>
      <td>service_cidr</td>
      <td> </td>
      <td>str</td>
      <td>null</td>
      <td>A CIDR notation IP range from which to assign service cluster IPs.</td>
    </tr>
    <tr>
      <td>dns_service_ip</td>
      <td> </td>
      <td>str</td>
      <td>null</td>
      <td>Containers DNS server IP address.</td>
    </tr>
    <tr>
      <td>docker_bridge_cidr</td>
      <td> </td>
      <td>str</td>
      <td>null</td>
      <td>A CIDR notation IP for Docker bridge.</td>
    </tr>
    <tr>
      <td>cluster_purpose</td>
      <td> </td>
      <td>str: <code class="language-plaintext highlighter-rouge">"DevTest"</code>, <code class="language-plaintext highlighter-rouge">"FastProd"</code></td>
      <td><code class="language-plaintext highlighter-rouge">"FastProd"</code></td>
      <td>Targeted usage of the cluster. This is used to provision Azure Machine Learning components to ensure the desired level of fault-tolerance and QoS. <code class="language-plaintext highlighter-rouge">"FastProd"</code> will provision components to handle higher levels of traffic with production quality fault-tolerance. This will default the AKS cluster to have 3 nodes. <code class="language-plaintext highlighter-rouge">"DevTest"</code> will provision components at a minimal level for testing. This will default the AKS cluster to have 1 node.</td>
    </tr>
    <tr>
      <td>vnet_resource_group_name</td>
      <td> </td>
      <td>str</td>
      <td>null</td>
      <td>The name of the resource group where the virtual network is located.</td>
    </tr>
    <tr>
      <td>vnet_name</td>
      <td> </td>
      <td>str</td>
      <td>null</td>
      <td>The name of the virtual network.</td>
    </tr>
    <tr>
      <td>subnet_name</td>
      <td> </td>
      <td>str</td>
      <td>null</td>
      <td>The name of the subnet inside the vnet.</td>
    </tr>
    <tr>
      <td>ssl_cname</td>
      <td> </td>
      <td>str</td>
      <td>null</td>
      <td>A CName to use if enabling SSL validation on the cluster. Must provide all three CName, cert file, and key file to enable SSL validation.</td>
    </tr>
    <tr>
      <td>ssl_cert_pem_file</td>
      <td> </td>
      <td>str</td>
      <td>null</td>
      <td>A file path to a file containing cert information for SSL validation. Must provide all three CName, cert file, and key file to enable SSL validation.</td>
    </tr>
    <tr>
      <td>ssl_key_pem_file</td>
      <td> </td>
      <td>str</td>
      <td>null</td>
      <td>A file path to a file containing key information for SSL validation. Must provide all three CName, cert file, and key file to enable SSL validation.</td>
    </tr>
    <tr>
      <td>load_balancer_type</td>
      <td> </td>
      <td>str: <code class="language-plaintext highlighter-rouge">"PublicIp"</code>, <code class="language-plaintext highlighter-rouge">"InternalLoadBalancer"</code></td>
      <td><code class="language-plaintext highlighter-rouge">"PublicIp"</code></td>
      <td>Load balancer type of AKS cluster.</td>
    </tr>
    <tr>
      <td>load_balancer_subnet</td>
      <td> </td>
      <td>str</td>
      <td>equal to subnet_name</td>
      <td>Load balancer subnet of AKS cluster. It can be used only when Internal Load Balancer is used as load balancer type.</td>
    </tr>
  </tbody>
</table>

<p>Please visit <a href="https://docs.microsoft.com/en-us/python/api/azureml-core/azureml.core.compute.amlcompute%28class%29?view=azure-ml-py#provisioning-configuration-vm-size-----vm-priority--dedicated---min-nodes-0--max-nodes-none--idle-seconds-before-scaledown-none--admin-username-none--admin-user-password-none--admin-user-ssh-key-none--vnet-resourcegroup-name-none--vnet-name-none--subnet-name-none--tags-none--description-none--remote-login-port-public-access--notspecified--">this website</a> for more details.</p>

<h3 id="outputs">Outputs</h3>

<p>This action does not provide any outputs.</p>

<h3 id="environment-variables">Environment variables</h3>

<p>Certain parameters are considered secrets and should therefore be passed as environment variables from your secrets, if you want to use custom values.</p>

<table>
  <thead>
    <tr>
      <th>Environment variable</th>
      <th>Required</th>
      <th>Allowed Values</th>
      <th>Default</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ADMIN_USER_NAME</td>
      <td> </td>
      <td>str</td>
      <td>null</td>
      <td>The name of the administrator user account which can be used to SSH into nodes. This parameter is AML Cluster specific.</td>
    </tr>
    <tr>
      <td>ADMIN_USER_PASSWORD</td>
      <td> </td>
      <td>str</td>
      <td>null</td>
      <td>The password of the administrator user account. This parameter is AML Cluster specific.</td>
    </tr>
    <tr>
      <td>ADMIN_USER_SSH_KEY</td>
      <td> </td>
      <td>str</td>
      <td>null</td>
      <td>The SSH public key of the administrator user account. This parameter is AML Cluster specific.</td>
    </tr>
  </tbody>
</table>

<h3 id="other-azure-machine-learning-actions">Other Azure Machine Learning Actions</h3>

<ul>
  <li><a href="https://github.com/Azure/aml-workspace">aml-workspace</a> - Connects to or creates a new workspace</li>
  <li><a href="https://github.com/Azure/aml-compute">aml-compute</a> - Connects to or creates a new compute target in Azure Machine Learning</li>
  <li><a href="https://github.com/Azure/aml-run">aml-run</a> - Submits a ScriptRun, an Estimator or a Pipeline to Azure Machine Learning</li>
  <li><a href="https://github.com/Azure/aml-registermodel">aml-registermodel</a> - Registers a model to Azure Machine Learning</li>
  <li><a href="https://github.com/Azure/aml-deploy">aml-deploy</a> - Deploys a model and creates an endpoint for the model</li>
</ul>

<h3 id="contributing">Contributing</h3>

<p>This project welcomes contributions and suggestions.  Most contributions require you to agree to a
Contributor License Agreement (CLA) declaring that you have the right to, and actually do, grant us
the rights to use your contribution. For details, visit https://cla.opensource.microsoft.com.</p>

<p>When you submit a pull request, a CLA bot will automatically determine whether you need to provide
a CLA and decorate the PR appropriately (e.g., status check, comment). Simply follow the instructions
provided by the bot. You will only need to do this once across all repos using our CLA.</p>

<p>This project has adopted the <a href="https://opensource.microsoft.com/codeofconduct/">Microsoft Open Source Code of Conduct</a>.
For more information see the <a href="https://opensource.microsoft.com/codeofconduct/faq/">Code of Conduct FAQ</a> or
contact <a href="mailto:opencode@microsoft.com">opencode@microsoft.com</a> with any additional questions or comments.</p>


</section>

<footer class="page-footer">
  <ul class="site-footer-links right">
    <li><a href="https://status.github.com/">Status</a></li>
    <li><a href="https://developer.github.com">API</a></li>
    <li><a href="https://training.github.com">Training</a></li>
    <li><a href="https://shop.github.com">Shop</a></li>
    <li><a href="https://github.com/blog">Blog</a></li>
    <li><a href="https://github.com/about">About</a></li>
  </ul>

  <a href="/">
    <span class="mega-octicon octicon-mark-github"></span>
  </a>

  <ul class="site-footer-links">
    <li>&copy; 2020 <span>GitHub</span>, Inc.</li>
    <li><a href="https://github.com/site/terms">Terms</a></li>
    <li><a href="https://github.com/site/privacy">Privacy</a></li>
    <li><a href="https://github.com/security">Security</a></li>
    <li><a href="https://github.com/contact">Contact</a></li>
  </ul>
</footer>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-3769691-40', 'github.com');
  ga('send', 'pageview');
</script>

</body>
</html>


